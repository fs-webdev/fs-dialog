<link rel="import" href="../fs-globals/fs-globals.html">
<link rel="import" href="../fs-dialog/fs-dialog-base.html">

<style data-fs-modal-dialog="">
/*
 * 1. The display property cannot be animated so we need to use opacity and visibility
 *    to fade in
 *    @see https://stackoverflow.com/questions/3331353/transitions-on-the-display-property
 * 2. Delay the visibility property so we can see the dialog disappear
 *    @see https://codepen.io/matthewlein/pen/fvrLD
 * 3. Support a fixed modal header/footer and scrollable middle
 * 4. Temporary hack until fs-styles removes background image from fs-dialog__close
 * 5. Safari's default active button color seems to be white (activebuttontext)
 */

fs-modal-dialog {
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%) scale(0.7);
}

fs-modal-dialog:not([no-transition]) {
  transition: opacity 0.3s, visibility 0s linear 0.3s, transform 0.3s; /* [2] */
}

</style>

<script>"use strict";function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),_get=function e(t,n,o){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,o)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(o)};!function(){function e(){setTimeout(function(){document.body.style.overflow=null,this._inertedElements.forEach(function(e){e.inert=!1}),this._uninertedElements.forEach(function(e){e.inert=!0}),this._inertedElements=null,this._uninertedElements=null}.bind(this),100)}function t(e){e&&e.target&&("FS-ANCHORED-DIALOG"===e.target.tagName||"FS-MODELESS-DIALOG"===e.target.tagName)&&function(e){e.inert=!1,e._uninertedElements=[e],e._inertedElements=[],el=e;do{var t=el.parentNode||el.host;t.inert&&(t.inert=!1,e._uninertedElements.push(t)),el=t}while(el!==document.body)}(e.target)}function n(t){t&&t.target&&("FS-ANCHORED-DIALOG"===t.target.tagName||"FS-MODELESS-DIALOG"===t.target.tagName)&&e.bind(t.target)()}var o=(document._currentScript||document.currentScript).ownerDocument,r=function(r){function i(){return _classCallCheck(this,i),_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).apply(this,arguments))}return _inherits(i,FS.dialog.baseDialogComponent),_createClass(i,[{key:"open",value:function(e){_get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"open",this).call(this,e)}},{key:"close",value:function(){_get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"close",this).call(this)}},{key:"attachedCallback",value:function(){this.appendStyles(o,"style[data-fs-modal-dialog]",this);var r,a=this.querySelector(".fs-dialog__body");this._a11yOpen=function(){this.inert=!1,this._inertedElements=[],this._uninertedElements=[];var e=this;do{var t=e.parentNode||e.host;t.inert&&(t.inert=!1,this._uninertedElements.push(t));for(var n,o=0;n=t.children[o];o++)n===e||n.hasAttribute("data-no-inert")||n.inert||(n.inert=!0,this._inertedElements.push(n));e=t}while(e!==document.body)}.bind(this),this._a11yClose=e.bind(this),_get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"attachedCallback",this).call(this,function(){this._a11yOpen(),r.addEventListener("keydown",s),void 0!==this.getAttribute("no-transition")&&null!==this.getAttribute("no-transition")?r.setAttribute("no-transition",""):r.removeAttribute("no-transition"),r.setAttribute("opened",""),r.style.zIndex=this.style.zIndex,window.addEventListener("fs-dialog-open",t),window.addEventListener("fs-dialog-close",n)},function(){window.removeEventListener("fs-dialog-open",t),window.removeEventListener("fs-dialog-close",n),this._a11yClose(),r.removeAttribute("opened"),r.removeEventListener("keydown",s)}),(r=document.createElement("div")).setAttribute("data-no-inert",""),r.setAttribute("tabindex","-1"),r.classList.add("fs-dialog__mask"),this.parentNode.insertBefore(r,this),a&&a.setAttribute("role","main");var s=this.keydownHandler.bind(this)}}],[{key:"properties",get:function(){var e;return e={opened:{type:Boolean,value:!1},transition:{type:string,value:""},"no-fullscreen-mobile":{type:boolean,value:!1},"data-dialog-dismiss":{type:Boolean,value:!1},"data-dialog-confirm":{type:Boolean,value:!1}},_defineProperty(e,"data-dialog-confirm",{type:Boolean,value:!1}),_defineProperty(e,"no-transition",{type:Boolean,value:!1}),_defineProperty(e,"no-close-button",{type:Boolean,value:!1}),e}}]),i}();"customElements"in window?customElements.define("fs-modal-dialog",r):document.registerElement("fs-modal-dialog",{prototype:Object.create(r.prototype)})}();</script>
